#!/bin/bash

jade views/*.jade -o .

stylus --include-css --compress -o . css/all.styl
cleancss --s0 -o all.css all.css

browserify_alone() {
  browserify $1 \
    --transform babelify \
    --plugin bundle-collapser/plugin \
    | uglifyjs \
      --mangle \
      --compress "comparisons=false,keep_fargs=true,unsafe=true,unsafe_comps=true,warnings=false" \
      --beautify "ascii_only=true,beautify=false" \
      --output $2
}

browserify_alone js/main.js all.js
browserify_alone js/service-worker.js service-worker.js
